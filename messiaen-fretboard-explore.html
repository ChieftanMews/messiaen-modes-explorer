<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Messiaen's Seven Modes of Limited Transposition</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            color: white;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(255, 107, 107, 0.3);
        }
        
        .subtitle {
            text-align: center;
            font-size: 1.2em;
            color: #888;
            margin-bottom: 30px;
        }
        
        .mode-tabs {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 5px;
            margin: 30px 0;
            padding: 0 20px;
        }
        
        .mode-tab {
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid transparent;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            backdrop-filter: blur(5px);
            min-width: 120px;
            text-align: center;
        }
        
        .mode-tab:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        
        .mode-tab.active {
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4);
            border-color: #fff;
            box-shadow: 0 5px 20px rgba(255, 107, 107, 0.4);
        }
        
        .mode-info {
            background: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }
        
        .mode-title {
            font-size: 1.5em;
            margin-bottom: 15px;
            color: #4ecdc4;
            text-align: center;
        }
        
        .scale-notes {
            text-align: center;
            font-size: 1.2em;
            margin: 15px 0;
            color: #ff6b6b;
            font-weight: bold;
        }
        
        .mode-description {
            margin-top: 15px;
            line-height: 1.6;
        }
        
        .fretboard-container {
            background: rgba(0, 0, 0, 0.3);
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow-x: auto;
        }
        
        .fretboard {
            display: grid;
            grid-template-columns: 80px repeat(15, 60px);
            gap: 2px;
            min-width: 1000px;
            margin: 0 auto;
        }
        
        .fret-number {
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #666;
            height: 40px;
            font-size: 14px;
        }
        
        .string-label {
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #999;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            height: 40px;
        }
        
        .fret {
            height: 40px;
            border: 1px solid #333;
            background: linear-gradient(to right, #2a2a2a, #1a1a1a);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .fret:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }
        
        .mode-note {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            color: white;
            border: 2px solid #ff8a80;
            box-shadow: 0 0 15px rgba(255, 107, 107, 0.6);
            animation: pulse 2s infinite;
        }
        
        .root-note {
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
            color: white;
            border: 2px solid #80cbc4;
            box-shadow: 0 0 20px rgba(78, 205, 196, 0.8);
            font-size: 12px;
            font-weight: 900;
        }
        
        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 15px rgba(255, 107, 107, 0.6); }
            50% { box-shadow: 0 0 25px rgba(255, 107, 107, 0.9); }
        }
        
        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
            border: 2px solid;
        }
        
        .inlay-marker {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            width: 8px;
            height: 8px;
            background: #666;
            border-radius: 50%;
        }
        
        .double-inlay {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 3px;
        }
        
        .double-inlay::before,
        .double-inlay::after {
            content: '';
            width: 6px;
            height: 6px;
            background: #666;
            border-radius: 50%;
        }
        
        .transposition-selector {
            text-align: center;
            margin: 20px 0;
        }
        
        .transposition-selector select {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 16px;
            backdrop-filter: blur(5px);
        }
        
        .transposition-selector select option {
            background: #2a2a2a;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Messiaen's Seven Modes of Limited Transposition</h1>
        <div class="subtitle">Interactive Guitar Fretboard Explorer</div>
        
        <div class="mode-tabs">
            <div class="mode-tab active" data-mode="1">Mode 1</div>
            <div class="mode-tab" data-mode="2">Mode 2</div>
            <div class="mode-tab" data-mode="3">Mode 3</div>
            <div class="mode-tab" data-mode="4">Mode 4</div>
            <div class="mode-tab" data-mode="5">Mode 5</div>
            <div class="mode-tab" data-mode="6">Mode 6</div>
            <div class="mode-tab" data-mode="7">Mode 7</div>
        </div>
        
        <div class="transposition-selector">
            <label for="root-select">Root Note: </label>
            <select id="root-select">
                <option value="C">C</option>
                <option value="C#">C#/D♭</option>
                <option value="D">D</option>
                <option value="D#">D#/E♭</option>
                <option value="E">E</option>
                <option value="F">F</option>
                <option value="F#" selected>F#/G♭</option>
                <option value="G">G</option>
                <option value="G#">G#/A♭</option>
                <option value="A">A</option>
                <option value="A#">A#/B♭</option>
                <option value="B">B</option>
            </select>
        </div>
        
        <div class="mode-info" id="mode-info">
            <!-- Mode information will be populated by JavaScript -->
        </div>
        
        <div class="fretboard-container">
            <div class="fretboard" id="fretboard">
                <!-- Fretboard will be generated by JavaScript -->
            </div>
        </div>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color root-note" style="border-color: #80cbc4;"></div>
                <span>Root Note</span>
            </div>
            <div class="legend-item">
                <div class="legend-color mode-note" style="border-color: #ff8a80;"></div>
                <span>Mode Notes</span>
            </div>
        </div>
    </div>

    <script>
        // Define the guitar tuning (standard tuning)
        const strings = [
            { name: 'E', note: 4 },  // High E (4th octave)
            { name: 'B', note: 3 },  // B (3rd octave)
            { name: 'G', note: 3 },  // G (3rd octave)
            { name: 'D', note: 3 },  // D (3rd octave)
            { name: 'A', note: 2 },  // A (2nd octave)
            { name: 'E', note: 2 }   // Low E (2nd octave)
        ];
        
        // Chromatic scale starting from C
        const chromaticScale = ['C', 'C#/D♭', 'D', 'D#/E♭', 'E', 'F', 'F#/G♭', 'G', 'G#/A♭', 'A', 'A#/B♭', 'B'];
        
        // Map note names to chromatic scale indices
        const noteToIndex = {
            'C': 0, 'C#': 1, 'D♭': 1, 'D': 2, 'D#': 3, 'E♭': 3, 'E': 4,
            'F': 5, 'F#': 6, 'G♭': 6, 'G': 7, 'G#': 8, 'A♭': 8, 'A': 9,
            'A#': 10, 'B♭': 10, 'B': 11
        };
        
        // Messiaen's seven modes of limited transposition (intervals from root)
        const modes = {
            1: {
                name: "Mode 1 (Whole-Tone Scale)",
                intervals: [0, 2, 4, 6, 8, 10], // All whole steps
                description: "The whole-tone scale consists entirely of whole steps (major seconds). This creates a dreamy, floating quality often associated with impressionist composers like Debussy. It lacks traditional leading tones, creating harmonic ambiguity.",
                characteristics: "6 unique pitches, symmetrical structure, no semitones"
            },
            2: {
                name: "Mode 2 (Octatonic/Diminished Scale)",
                intervals: [0, 1, 3, 4, 6, 7, 9, 10], // Alternating half and whole steps
                description: "The octatonic or diminished scale alternates between half steps and whole steps. This mode has a mysterious, Eastern quality and is frequently used in Messiaen's compositions and modern jazz.",
                characteristics: "8 unique pitches, alternating intervals, symmetric"
            },
            3: {
                name: "Mode 3",
                intervals: [0, 2, 3, 4, 6, 7, 8, 10, 11], // Nine-note scale
                description: "A nine-note scale with a complex interval pattern. This mode combines major and minor seconds in a specific sequence, creating rich harmonic possibilities.",
                characteristics: "9 unique pitches, complex interval structure"
            },
            4: {
                name: "Mode 4",
                intervals: [0, 1, 2, 5, 6, 7, 8, 11], // Eight-note scale
                description: "An eight-note scale featuring chromatic clusters alternating with larger intervals. This mode creates tension through its juxtaposition of close and distant intervals.",
                characteristics: "8 unique pitches, chromatic clusters"
            },
            5: {
                name: "Mode 5",
                intervals: [0, 1, 5, 6, 7, 11], // Six-note scale
                description: "A six-note scale with a distinctive pattern combining semitones and perfect fourths. This mode has an exotic, pentatonic-like quality but with chromatic inflections.",
                characteristics: "6 unique pitches, fourths and semitones"
            },
            6: {
                name: "Mode 6",
                intervals: [0, 2, 4, 5, 6, 8, 10, 11], // Eight-note scale
                description: "An eight-note scale that combines whole steps with chromatic movement. This mode offers rich harmonic colors while maintaining some tonal center gravity.",
                characteristics: "8 unique pitches, mixed intervals"
            },
            7: {
                name: "Mode 7",
                intervals: [0, 1, 2, 3, 5, 6, 7, 8, 9, 11], // Ten-note scale
                description: "The most chromatic of Messiaen's modes, containing ten different pitches. This mode includes most of the chromatic scale while omitting only two notes, creating maximum harmonic density.",
                characteristics: "10 unique pitches, highly chromatic"
            }
        };
        
        let currentMode = 1;
        let currentRoot = 'F#';
        
        // Function to get note at fret
        function getNoteAtFret(stringNote, fret) {
            const stringIndex = noteToIndex[stringNote];
            const noteIndex = (stringIndex + fret) % 12;
            return chromaticScale[noteIndex];
        }
        
        // Function to get mode notes based on root and mode
        function getModeNotes(root, mode) {
            const rootIndex = noteToIndex[root];
            const intervals = modes[mode].intervals;
            return intervals.map(interval => {
                const noteIndex = (rootIndex + interval) % 12;
                return chromaticScale[noteIndex];
            });
        }
        
        // Function to check if note is in the current mode
        function isInMode(note, modeNotes) {
            return modeNotes.includes(note);
        }
        
        // Function to check if note is root
        function isRoot(note, rootNote) {
            return chromaticScale[noteToIndex[rootNote]] === note;
        }
        
        // Function to get display name for note
        function getDisplayName(note, modeNotes, rootNote) {
            if (isRoot(note, rootNote)) {
                return rootNote === 'F#' ? 'G♭' : rootNote;
            }
            
            // Convert enharmonic equivalents to more readable forms
            let displayNote = note;
            if (note.includes('/')) {
                const [sharp, flat] = note.split('/');
                // Choose the more common enharmonic spelling
                displayNote = flat; // Generally prefer flats for readability
            }
            
            return displayNote;
        }
        
        // Function to update mode information
        function updateModeInfo() {
            const modeInfo = document.getElementById('mode-info');
            const mode = modes[currentMode];
            const modeNotes = getModeNotes(currentRoot, currentMode);
            
            const noteNames = modeNotes.map(note => {
                let displayNote = note;
                if (note.includes('/')) {
                    displayNote = note.split('/')[1]; // Use flat version
                }
                return displayNote;
            }).join(' - ');
            
            modeInfo.innerHTML = `
                <div class="mode-title">${mode.name}</div>
                <div class="scale-notes">Notes: ${noteNames}</div>
                <div class="mode-description">
                    <p><strong>Description:</strong> ${mode.description}</p>
                    <p><strong>Characteristics:</strong> ${mode.characteristics}</p>
                </div>
            `;
        }
        
        // Function to generate fretboard
        function generateFretboard() {
            const fretboard = document.getElementById('fretboard');
            fretboard.innerHTML = ''; // Clear existing content
            
            const modeNotes = getModeNotes(currentRoot, currentMode);
            
            // Add fret numbers header
            const emptyCorner = document.createElement('div');
            emptyCorner.className = 'string-label';
            fretboard.appendChild(emptyCorner);
            
            for (let fret = 0; fret <= 14; fret++) {
                const fretNum = document.createElement('div');
                fretNum.className = 'fret-number';
                fretNum.textContent = fret === 0 ? 'Open' : fret;
                fretboard.appendChild(fretNum);
            }
            
            // Add strings and frets
            strings.forEach(string => {
                // String label
                const stringLabel = document.createElement('div');
                stringLabel.className = 'string-label';
                stringLabel.textContent = string.name;
                fretboard.appendChild(stringLabel);
                
                // Frets for this string
                for (let fret = 0; fret <= 14; fret++) {
                    const fretDiv = document.createElement('div');
                    fretDiv.className = 'fret';
                    
                    const note = getNoteAtFret(string.name, fret);
                    
                    if (isInMode(note, modeNotes)) {
                        if (isRoot(note, currentRoot)) {
                            fretDiv.classList.add('root-note');
                            fretDiv.textContent = getDisplayName(note, modeNotes, currentRoot);
                        } else {
                            fretDiv.classList.add('mode-note');
                            fretDiv.textContent = getDisplayName(note, modeNotes, currentRoot);
                        }
                    }
                    
                    // Add position markers
                    if (fret === 3 || fret === 5 || fret === 7 || fret === 9) {
                        if (string.name === 'D') { // Only show on middle string
                            const marker = document.createElement('div');
                            marker.className = 'inlay-marker';
                            fretDiv.appendChild(marker);
                        }
                    } else if (fret === 12) {
                        if (string.name === 'D') { // Only show on middle string
                            const marker = document.createElement('div');
                            marker.className = 'double-inlay';
                            fretDiv.appendChild(marker);
                        }
                    }
                    
                    fretboard.appendChild(fretDiv);
                }
            });
        }
        
        // Function to update display
        function updateDisplay() {
            updateModeInfo();
            generateFretboard();
        }
        
        // Event listeners for mode tabs
        document.querySelectorAll('.mode-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                // Remove active class from all tabs
                document.querySelectorAll('.mode-tab').forEach(t => t.classList.remove('active'));
                // Add active class to clicked tab
                tab.classList.add('active');
                
                // Update current mode
                currentMode = parseInt(tab.dataset.mode);
                updateDisplay();
            });
        });
        
        // Event listener for root note selector
        document.getElementById('root-select').addEventListener('change', (e) => {
            currentRoot = e.target.value;
            updateDisplay();
        });
        
        // Initialize display when page loads
        document.addEventListener('DOMContentLoaded', () => {
            updateDisplay();
        });
    </script>
</body>
</html>
